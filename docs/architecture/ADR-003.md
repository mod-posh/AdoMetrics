# ADR-003: Projection layer for selection/rename and custom metrics

## Title

**ADR-003: Projection is a view; canonical store stays canonical.**

### Status

Proposed

### Context

Users want:

* only a subset of fields exported/reported
* renaming fields (e.g., `requestedFor` → `userAccount`)
* “lifting” derived values into named output columns
* defining additional custom derived metrics beyond default extraction

If we let users mutate the canonical store shape, we risk losing durability and compatibility over time.

### Decision

1. Introduce a **projection layer** that creates a *view* over canonical metric rows:

   * Field selection (include/exclude)
   * Field rename (aliasing)
   * Optional lifting of `derived.*` fields into projected top-level fields
2. Projection operates at output time:

   * Does not change the canonical store unless the consumer explicitly exports a projected file.
3. Projection config lives in a metrics profile (or separate projection profile), not in code.

### Consequences

* Pros:

  * Canonical store remains stable and reusable for any future reporting
  * Users can tailor outputs without breaking ingestion/persistence
  * Enables Excel/SharePoint integrations without changing the engine
* Cons:

  * Adds complexity (two layers: canonical vs projected)
  * Requires clear documentation to prevent confusion

### Non-goals

* The module will not define “weekly/monthly/yearly” job orchestration.

  * Time windows may exist as pure helper primitives, but scheduling remains consumer-side.
